# Generated by $(version) ($(date))
#	WITH_DYNLIB		compile for dynamically-linkable library

RANLIB?=ranlib

SOURCES = api.c \
	fetch.c \
	decode.c \
	debug.c \
	$(foreach modules) \
	$(name).c$(end)$(foreach sources) \
	$(path)$(end)

OBJECTS=$$(SOURCES:.c=.o)

CLEAN = $$(OBJECTS)
DISTCLEAN = lib$(proc).a

CFLAGS += -g3 -O3 $(foreach modules)$(CFLAGS)$(end) -I../include
ifdef WITH_DYNLIB
CFLAGS += -fPIC
endif

$(if NO_PAGE_INIT)
CFLAGS += -D$(PROC)_NO_PAGE_INIT
$(end)

all: lib$(proc).a

lib$(proc).a: $$(OBJECTS)
	$$(AR) rcsu $$@ $$^
	$$(RANLIB) $$@

clean:
	-rm -rf $$(CLEAN)

distclean: clean
	-rm -rf $$(DISTCLEAN)

# other dependencies
fetch.o: fetch_table.h
code.o: code_table.h
decode.o: decode_table.h
